---
import BaseLayout from '@/layouts/BaseLayout.astro'
import Breadcrumbs from '../../../packages/shared/src/components/Breadcrumbs.astro'
---

<BaseLayout meta={{ title: 'Contribution Guide', description: 'Step-by-step guide to contributing' }}>
  <div class="flex w-full flex-col">
    
    <Breadcrumbs items={[
      { label: 'Home', href: '/' },
      { label: 'Contribute', href: '/contribute' },
      { label: 'Guide' }
    ]} />

    <h1 class="mt-6 text-2xl font-bold text-foreground sm:text-3xl">Contribution Guide</h1>
    <p class="mt-2 text-base text-muted-foreground">
      Step-by-step instructions for data scientists. Use AI to help you through tricky parts.
    </p>

    <!-- Main Layout: Sidebar + Content -->
    <div class="mt-8 flex gap-8">
      
      <!-- Sticky Sidebar TOC (hidden on mobile) -->
      <nav class="hidden lg:block w-48 shrink-0">
        <div class="sticky top-24">
          <h2 class="text-sm font-bold text-foreground mb-3">On this page</h2>
          <ol class="space-y-2 text-sm border-l border-border pl-4">
            <li><a href="#prerequisites" class="text-muted-foreground hover:text-foreground">Prerequisites</a></li>
            <li><a href="#setup" class="text-muted-foreground hover:text-foreground">Setup</a></li>
            <li><a href="#fix-existing" class="text-muted-foreground hover:text-foreground">Fix Existing App</a></li>
            <li><a href="#build-new" class="text-muted-foreground hover:text-foreground">Build New App</a></li>
            <li><a href="#testing" class="text-muted-foreground hover:text-foreground">Testing</a></li>
            <li><a href="#submitting" class="text-muted-foreground hover:text-foreground">Submitting</a></li>
            <li><a href="#ai-tips" class="text-muted-foreground hover:text-foreground">AI Tips</a></li>
          </ol>
        </div>
      </nav>

      <!-- Content -->
      <div class="flex-1 min-w-0 prose prose-neutral dark:prose-invert max-w-none">

        <!-- Prerequisites -->
        <section id="prerequisites">
          <h2>Prerequisites</h2>
          <div class="not-prose overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="border-b border-border">
                  <th class="text-left py-2 px-3">Tool</th>
                  <th class="text-left py-2 px-3">Check</th>
                  <th class="text-left py-2 px-3">Install</th>
                </tr>
              </thead>
              <tbody>
                <tr class="border-b border-border">
                  <td class="py-2 px-3">Node.js 20+</td>
                  <td class="py-2 px-3"><code class="bg-muted px-1.5 py-0.5 rounded">node -v</code></td>
                  <td class="py-2 px-3"><a href="https://nodejs.org/" class="underline">nodejs.org</a></td>
                </tr>
                <tr class="border-b border-border">
                  <td class="py-2 px-3">pnpm 9+</td>
                  <td class="py-2 px-3"><code class="bg-muted px-1.5 py-0.5 rounded">pnpm -v</code></td>
                  <td class="py-2 px-3"><code class="bg-muted px-1.5 py-0.5 rounded">npm i -g pnpm</code></td>
                </tr>
                <tr class="border-b border-border">
                  <td class="py-2 px-3">Git</td>
                  <td class="py-2 px-3"><code class="bg-muted px-1.5 py-0.5 rounded">git --version</code></td>
                  <td class="py-2 px-3"><a href="https://git-scm.com/" class="underline">git-scm.com</a></td>
                </tr>
                <tr class="border-b border-border">
                  <td class="py-2 px-3">Python 3.11+ (notebooks)</td>
                  <td class="py-2 px-3"><code class="bg-muted px-1.5 py-0.5 rounded">python --version</code></td>
                  <td class="py-2 px-3"><a href="https://python.org/" class="underline">python.org</a></td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Setup -->
        <section id="setup">
          <h2>Setup</h2>
          
          <h3>1. Fork & Clone</h3>
          <p>Fork <a href="https://github.com/eeshansrivastava89/ds-apps-main">the repo</a>, then:</p>
          <pre><code class="language-bash">git clone https://github.com/YOUR-USERNAME/ds-apps-main.git
cd ds-apps-main</code></pre>

          <h3>2. Install Dependencies</h3>
          <pre><code class="language-bash">pnpm install</code></pre>

          <h3>3. Environment Variables</h3>
          <pre><code class="language-bash">cp .env.example .env</code></pre>
          <p>Leave blank for local dev‚Äîfeatures gracefully degrade without PostHog/Supabase.</p>

          <h3>4. Run Dev Server</h3>
          <pre><code class="language-bash">pnpm dev</code></pre>
          <p>Open <a href="http://localhost:4321">localhost:4321</a> üéâ</p>
        </section>

        <!-- Fix Existing -->
        <section id="fix-existing">
          <h2>Fix Existing App</h2>
          <ol>
            <li><strong>Find an issue</strong> ‚Äî Browse <a href="https://github.com/eeshansrivastava89/ds-apps-main/issues?q=is%3Aissue+is%3Aopen">open issues</a>. Look for <code>diff:easy</code> labels.</li>
            <li><strong>Claim it</strong> ‚Äî Comment "I'll work on this"</li>
            <li><strong>Branch</strong> ‚Äî <code>git checkout -b feature/your-name-topic</code></li>
            <li><strong>Fix & test</strong> ‚Äî Make changes, verify with <code>pnpm dev</code></li>
            <li><strong>Submit</strong> ‚Äî See <a href="#submitting">Submitting</a></li>
          </ol>
        </section>

        <!-- Build New -->
        <section id="build-new">
          <h2>Build New App</h2>
          
          <h3>1. Propose Your Idea</h3>
          <p>Open a <a href="https://github.com/eeshansrivastava89/ds-apps-main/discussions/new?category=new-data-science-web-app-proposals">GitHub Discussion</a> with:</p>
          <ul>
            <li>What the app does</li>
            <li>What data it generates</li>
            <li>What analysis you'll do</li>
          </ul>

          <h3>2. Scaffold with the Script</h3>
          <p>Once approved, run:</p>
          <pre><code class="language-bash">node scripts/create-package.mjs your-app "Your App Name" "Short description"</code></pre>
          
          <p>This creates:</p>
          <ul>
            <li><code>packages/your-app/</code> ‚Äî Full Astro package</li>
            <li><code>src/pages/projects/your-app.astro</code> ‚Äî Hub page</li>
            <li><code>packages/shared/src/data/projects/your-app.yaml</code> ‚Äî Project data</li>
            <li><code>analytics/notebooks/your-app/</code> ‚Äî Sample notebook</li>
            <li><code>src/content/post/your-app-getting-started.md</code> ‚Äî Sample post</li>
          </ul>

          <h3>3. Build Your App</h3>
          <pre><code class="language-bash">pnpm install
pnpm --filter @eeshans/your-app dev</code></pre>
          <p>Your app runs at <code>localhost:4321/your-app/</code></p>

          <h3>4. Add Analytics (Optional)</h3>
          <p><strong>PostHog:</strong> Namespace your events: <code>posthog.capture('your_app_event_name')</code></p>
          <p><strong>Supabase:</strong> Use <code>internal/supabase-schema-template.sql</code> as a starting point.</p>
        </section>

        <!-- Testing -->
        <section id="testing">
          <h2>Testing</h2>
          <pre><code class="language-bash"># Dev mode (auto-reload)
pnpm dev

# Build (catches errors not shown in dev)
pnpm build

# Preview production build
pnpm preview</code></pre>
          
          <p><strong>Checklist:</strong></p>
          <ul>
            <li>‚úÖ Changes work as expected</li>
            <li>‚úÖ No console errors (F12)</li>
            <li>‚úÖ Mobile responsive</li>
            <li>‚úÖ <code>pnpm build</code> passes</li>
          </ul>
        </section>

        <!-- Submitting -->
        <section id="submitting">
          <h2>Submitting</h2>
          
          <pre><code class="language-bash"># Commit
git add .
git commit -m "feat: add X to Y"

# Push
git push origin feature/your-branch</code></pre>

          <p>Then open a PR on GitHub with:</p>
          <ul>
            <li>What does this PR do?</li>
            <li>Link to issue (if applicable)</li>
            <li>Screenshots (for UI changes)</li>
          </ul>

          <p>Commit prefixes: <code>feat:</code> <code>fix:</code> <code>docs:</code> <code>refactor:</code></p>
        </section>

        <!-- AI Tips -->
        <section id="ai-tips">
          <h2>AI Tips</h2>
          <p>I use AI for ~80% of coding. Here's what works:</p>
          
          <h3>Give Context</h3>
          <p>"I'm contributing to a data science portfolio site built with Astro. Here's the relevant code: [paste]"</p>
          
          <h3>Share Examples</h3>
          <p>"Here's an existing component that does something similar: [paste]. Help me create my version."</p>
          
          <h3>Explain Errors</h3>
          <p>"I got this error: [paste]. Here's the code: [paste]. What's wrong?"</p>
          
          <p class="mt-4"><strong>Read more:</strong> <a href="/writing/how-i-ai">How I AI</a></p>
        </section>

        <!-- Footer -->
        <section class="mt-12 border-t border-border pt-6">
          <p>Questions? Open a <a href="https://github.com/eeshansrivastava89/ds-apps-main/discussions">Discussion</a>.</p>
          <p class="mt-4"><a href="/contribute" class="text-muted-foreground hover:text-foreground">‚Üê Back to Contribute</a></p>
        </section>

      </div>
    </div>

  </div>
</BaseLayout>

<style>
  pre {
    @apply rounded-lg border border-border bg-zinc-900 p-4 overflow-x-auto text-sm;
  }
  pre code {
    @apply bg-transparent p-0 text-zinc-100;
  }
  :not(pre) > code {
    @apply bg-muted px-1.5 py-0.5 rounded text-sm;
  }
  .prose a {
    @apply text-foreground underline hover:text-muted-foreground;
  }
  section {
    @apply mt-10;
  }
  section:first-of-type {
    @apply mt-0;
  }
</style>

<script is:inline>
  // Highlight current section in TOC based on scroll
  document.addEventListener('DOMContentLoaded', () => {
    const sections = document.querySelectorAll('section[id]')
    const navLinks = document.querySelectorAll('nav a[href^="#"]')
    
    if (!sections.length || !navLinks.length) return
    
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          navLinks.forEach(link => {
            link.classList.remove('text-foreground', 'font-medium')
            link.classList.add('text-muted-foreground')
            if (link.getAttribute('href') === '#' + entry.target.id) {
              link.classList.add('text-foreground', 'font-medium')
              link.classList.remove('text-muted-foreground')
            }
          })
        }
      })
    }, { rootMargin: '-20% 0px -60% 0px' })
    
    sections.forEach(section => observer.observe(section))
  })
</script>
