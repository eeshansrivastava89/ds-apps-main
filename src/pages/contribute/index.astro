---
import BaseLayout from '@/layouts/BaseLayout.astro'
import Breadcrumbs from '../../../packages/shared/src/components/Breadcrumbs.astro'
import Contributors from '@/components/Contributors.astro'
import { Icon } from 'astro-icon/components'
import { getLiveProjects, getProjectsByStatus, STATUS_CONFIG } from '../../../packages/shared/src/lib/projects'
import { getAllProjects } from '../../../packages/shared/src/data/projectLoader'

const allProjects = getAllProjects()
const liveProjects = getLiveProjects(allProjects)
const inProgressProjects = getProjectsByStatus(allProjects, 'in-progress')
---

<BaseLayout meta={{ title: 'Build With Me' }}>
  <div class="flex w-full flex-col">
    <Breadcrumbs currentLabel="Contribute" />

    <!-- Hero -->
    <section class="mt-6 mb-8">
      <h1 class="text-2xl font-bold text-foreground sm:text-3xl">Build With Me</h1>
      <p class="mt-2 text-base text-muted-foreground">
        I'm building data science tools in public. Contribute to existing projects or build your own.
      </p>
    </section>

    <!-- Two Column: Options -->
    <div class="grid gap-6 lg:grid-cols-2">
      
      <!-- Option 1: Fix Existing -->
      <div class="border border-border bg-primary-foreground p-6">
        <h2 class="text-lg font-bold text-foreground mb-3">Fix or Enhance Existing Apps</h2>
        <ul class="space-y-2 text-base text-muted-foreground mb-4">
          <li>Browse <a href="https://github.com/eeshansrivastava89/ds-apps-main/issues?q=is%3Aissue+is%3Aopen" class="underline hover:text-foreground">open issues</a></li>
          <li>Claim by commenting</li>
          <li>Branch, fix, PR</li>
        </ul>
        <div class="flex gap-3">
          <a href="/contribute/guide#fix-existing" class="inline-block px-4 py-2 bg-foreground text-background text-sm font-medium hover:bg-foreground/90">Detailed Guide â†’</a>
          <a href="https://github.com/eeshansrivastava89/ds-apps-main" class="inline-block px-4 py-2 border border-border text-sm hover:bg-muted">View Source</a>
        </div>
      </div>

      <!-- Option 2: Build New -->
      <div class="border border-border bg-primary-foreground p-6">
        <h2 class="text-lg font-bold text-foreground mb-3">Build a New Web App</h2>
        <ul class="space-y-2 text-base text-muted-foreground mb-4">
          <li>Propose via <a href="https://github.com/eeshansrivastava89/ds-apps-main/discussions/new?category=new-data-science-web-app-proposals" class="underline hover:text-foreground">Discussion</a></li>
          <li>Run <code class="bg-muted px-1.5 py-0.5 rounded text-sm">node scripts/create-package.mjs</code></li>
          <li>Build, analyze, ship</li>
        </ul>
        <a href="/contribute/guide#build-new" class="inline-block px-4 py-2 bg-foreground text-background text-sm font-medium hover:bg-foreground/90">Detailed Guide â†’</a>
      </div>

    </div>

    <!-- Guide CTA -->
    <div class="mt-6 p-4 border-2 border-dashed border-amber-400 dark:border-amber-600 bg-amber-50 dark:bg-amber-950/30">
      <p class="font-medium text-amber-800 dark:text-amber-200">
        ðŸš€ New to contributing? <a href="/contribute/guide" class="underline hover:text-amber-900 dark:hover:text-amber-100 font-bold">Read the step-by-step guide â†’</a>
      </p>
    </div>

    <!-- Contributors -->
    <section class="mt-8 border border-border bg-primary-foreground p-6">
      <h2 class="text-lg font-bold text-foreground mb-4">Recent Contributors</h2>
      <Contributors days={90} maxDisplay={8} />
    </section>

    <!-- Current Projects -->
    <section class="mt-6 border border-border bg-primary-foreground p-6">
      <h2 class="text-lg font-bold text-foreground mb-3">Current Projects</h2>
      <div class="space-y-3">
        {liveProjects.map((project) => (
          <div class="flex items-center justify-between border border-border bg-background p-3">
            <div class="flex items-center gap-3">
              <span class={`w-2 h-2 rounded-full ${STATUS_CONFIG[project.status].dotColor}`}></span>
              <div>
                <span class="font-medium">{project.name}</span>
                <span class="text-sm text-muted-foreground ml-2 hidden sm:inline">{project.shortDescription}</span>
              </div>
            </div>
            <div class="flex gap-3 text-sm">
              {project.url && project.url !== '#' && (
                <a href={project.url} class="text-foreground underline">Try â†’</a>
              )}
              {project.hubUrl && (
                <a href={project.hubUrl} class="text-muted-foreground underline hover:text-foreground">Docs</a>
              )}
            </div>
          </div>
        ))}
        {inProgressProjects.map((project) => (
          <div class="flex items-center justify-between border border-border bg-background p-3 opacity-60">
            <div class="flex items-center gap-3">
              <span class={`w-2 h-2 rounded-full ${STATUS_CONFIG[project.status].dotColor}`}></span>
              <div>
                <span class="font-medium">{project.name}</span>
                <span class="text-sm text-muted-foreground ml-2">({STATUS_CONFIG[project.status].label})</span>
              </div>
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Workflow -->
    <section class="mt-6 border border-border bg-primary-foreground p-6">
      <h2 class="text-lg font-bold text-foreground mb-3">Workflow Tips</h2>
      <ul class="space-y-1 text-base text-muted-foreground">
        <li><strong class="text-foreground">Use AI</strong> â€” <a href="/writing/how-i-ai" class="underline hover:text-foreground">How I AI</a> explains my approach</li>
        <li><strong class="text-foreground">Test before PR</strong> â€” <code class="bg-muted px-1.5 py-0.5 rounded text-sm">pnpm dev</code> â†’ <code class="bg-muted px-1.5 py-0.5 rounded text-sm">pnpm build</code></li>
      </ul>
    </section>

    <!-- Stack -->
    <section class="mt-6 border border-border bg-primary-foreground p-6">
      <h2 class="text-lg font-bold text-foreground mb-4">Stack</h2>
      <div class="space-y-4">
        <div>
          <h3 class="text-sm font-medium text-muted-foreground mb-2">Frontend</h3>
          <div class="flex flex-wrap items-center gap-x-2 text-base">
            <a href="https://astro.build/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:astro" class="h-4 w-4" /> Astro
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://react.dev/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:react" class="h-4 w-4" /> React
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://tailwindcss.com/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:tailwindcss" class="h-4 w-4" /> Tailwind
            </a>
          </div>
        </div>
        <div>
          <h3 class="text-sm font-medium text-muted-foreground mb-2">Backend</h3>
          <div class="flex flex-wrap items-center gap-x-2 text-base">
            <a href="https://supabase.com/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:supabase" class="h-4 w-4" /> Supabase
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://posthog.com/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:posthog" class="h-4 w-4" /> PostHog
            </a>
          </div>
        </div>
        <div>
          <h3 class="text-sm font-medium text-muted-foreground mb-2">Infrastructure</h3>
          <div class="flex flex-wrap items-center gap-x-2 text-base">
            <a href="https://fly.io/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:flydotio" class="h-4 w-4" /> Fly.io
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://github.com/features/actions" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:githubactions" class="h-4 w-4" /> Actions
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://cloudflare.com/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:cloudflare" class="h-4 w-4" /> Cloudflare
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://papermill.readthedocs.io/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:jupyter" class="h-4 w-4" /> Papermill
            </a>
          </div>
        </div>
        <div>
          <h3 class="text-sm font-medium text-muted-foreground mb-2">Data Science</h3>
          <div class="flex flex-wrap items-center gap-x-2 text-base">
            <a href="https://python.org/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:python" class="h-4 w-4" /> Python
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://pandas.pydata.org/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:pandas" class="h-4 w-4" /> Pandas
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://plotly.com/python/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:plotly" class="h-4 w-4" /> Plotly
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://www.statsmodels.org/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:scipy" class="h-4 w-4" /> Statsmodels
            </a>
            <span class="text-muted-foreground">|</span>
            <a href="https://seaborn.pydata.org/" target="_blank" rel="noopener noreferrer" class="flex items-center gap-1.5 text-foreground underline">
              <Icon name="simple-icons:python" class="h-4 w-4" /> Seaborn
            </a>
          </div>
        </div>
      </div>
    </section>

  </div>
</BaseLayout>
